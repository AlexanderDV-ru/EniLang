<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>EniLang - Language Assembler</title>

	<style>
		body {
			background-color: #333;
		}
		</style>
		</head>
	<body>
		<textarea style="width: 500px" id="enterArea"></textarea>
		<input type="checkbox" id="fullDescriptionCheckbox">
		<input type="number" id="languageInput" value="0">
		<br>
		<textarea style="width: 500px;height: 800px" id="fonemsDescriptionArea"></textarea>
		<textarea style="width: 500px;height: 800px" id="wordsDescriptionArea"></textarea>
		//Properties script
		<script>
var tabSym="\t"
var fonemsFlags=`
мк мягкость
	=мг мягкие
	=тв твердые
гс гласность
	=гл гласный
	=сг согласный
сп0  способ0
	=шм  шумные
	=сн  сонанты
	=щл  щелкающие
сп1  способ1
	=см  смычной
	=фр  фрикативный
	=дж  дрожащие
	=нс  носовые
	=ап  аппроксиманты
сп2  способ2
	=бк  боковые
	=ск  скользящие
	=му  многоударные
	=оу  одноударные
гл  глухость
	=зв  звонкие
	=гх  глухие
мс0 место0
	=гб  губные
	=бк  боковые
	=пя  переднеязычные
	=ув  увулярные
	=лг  ларингалы
	=вл  велярные
мс1 место1
	=гб  губные
	=зб  зубные
	=ал  альвеолярные
	=па  постальвеолярные
	=пл палатальные
	=ч   чистые
	=фг  фарингальные
	=гт  глоттальные
мс2 место2
	=ла  палатоальвеолярные
	=рф  ретрофлексные
	=ап  альвеопалатальные
	=эг  эпиглоттальные
	
вс  высота
	=вх  Верхние	
	=вн  Верхние-Ненапряжённые
	=вс  Верхние-Средне
	=ср  Средние
	=нс  Нижние-Средне
	=нн  Нижние-Ненапряжённые
	=нж  Нижние	
дл  долгота	
	=пр  Передние
	=пн  Передние-Ненапряжённые 
	=сд  Средние
	=зн  Задние-Ненапряжённые 
	=зд  Задние	
ол  огубленность
	=нг  неогубленные
	=ог  огубленные
тн  тон
	=вс высокий
	=нз низкий
	=вх восходящий
	=нх нисходящий
	=нв нисходяще-восходящий
	=вн восходяще-нисходящий
ур  ударение
	=уд ударный
	=нд неударный
дт  длительность
	=кр короткий
	=ср средний
	=дл длинный
`
var fonemsConfig=`
мягкие_глухие_шумные_смычные
	+P|П+	   -мс0=гб
	+T|Т+	   -мс0=пя
	+K|К+	   -мс0=вл  -1
мягкие_звонкие_шумные_смычные
	+B|Б+	   -мс0=гб
	+D|Д+	   -мс0=пя
	+G|Г+	   -мс0=вл  -1
мягкие_глухие_шумные_фрикативные
	+F|Ф+	   -мс0=гб  -2
	+S|С+	   -мс0=пя -мс1=ал
	+X|Ш+	   -мс0=пя -мс1=па -мс2=па
	+H|Х+	   -мс0=вл  -1
	+[ENGLISH_H]|[АНГЛИЙСКАЯ_Х]+	   -мс0=лг -мс1=гт
мягкие_звонкие_шумные_фрикативные
	+V|В+	   -мс0=гб  -2
	+Z|З+	   -мс0=пя -мс1=ал  
	+J|Ж+	   -мс0=пя -мс1=па -мс2=па  
	+Q|Ъ+	   -мс0=вл  -1
мягкие_скользящие
	+Y|Й+   -1
	+W|Я+   -2  -мс0=вл -мс1=гб
мягкие_сонанты
	+M|М+   -сп1=нс	-мс0=гб	-мс1=гб 
	+N|Н+   -сп1=нс	-мс0=пя	-мс1=ал 
	+L|Л+   -сп1=ап  -сп2=бк	-мс0=пя	-мс1=ал 
	+R|Р+   -сп1=др  -сп2=му	-мс0=пя	-мс1=ал 
	мягкие_скользящие  -сп1=ап  -сп2=ск
мягкие_шумные_смычные
	мягкие_глухие_шумные_смычные	-гл=гх
	мягкие_звонкие_шумные_смычные	-гл=зв
мягкие_шумные_фрикативные
	мягкие_глухие_шумные_фрикативные	-гл=гх
	мягкие_звонкие_шумные_фрикативные -гл=зв
мягкие_шумные
	мягкие_шумные_смычные   -сп1=см
	мягкие_шумные_фрикативные   -сп1=фр
мягкие_согласные
	мягкие_шумные   -сп0=шм 
	мягкие_сонанты  -сп0=сн
мягкие_гласные
	+A|А+
	+O|О+
	+E|Э+
	+I|Ы+	 -1
	+U|У+	 -2
мягкие_fonemos
	мягкие_согласные   -гс=сг
	мягкие_гласные	 -гс=гл
	
твердые_глухие_шумные_смычные
	+p|п+	   -мс0=гб
	+t|т+	   -мс0=пя
	+k|к+	   -мс0=вл  -1
твердые_звонкие_шумные_смычные
	+b|б+	   -мс0=гб
	+d|д+	   -мс0=пя
	+g|г+	   -мс0=вл  -1
твердые_глухие_шумные_фрикативные
	+f|ф+	   -мс0=гб  -2
	+s|с+	   -мс0=пя -мс1=ал
	+x|ш+	   -мс0=пя -мс1=па -мс2=па
	+h|х+	   -мс0=вл  -1
	+[english_h]|[английская_х]+	   -мс0=лг -мс1=гт
твердые_звонкие_шумные_фрикативные
	+v|в+	   -мс0=гб  -2
	+z|з+	   -мс0=пя -мс1=ал  
	+j|ж+	   -мс0=пя -мс1=па -мс2=па  
	+q|ъ+	   -мс0=вл  -1
твердые_скользящие
	+y|й+   -1
	+w|я+   -2
твердые_сонанты
	+m|м+   -сп1=нс	-мс0=гб	-мс1=гб 
	+n|н+   -сп1=нс	-мс0=пя	-мс1=ал 
	+l|л+   -сп1=ап  -сп2=бк	-мс0=пя	-мс1=ал 
	+r|р+   -сп1=др  -сп2=му	-мс0=пя	-мс1=ал 
	твердые_скользящие  -сп1=ап  -сп2=ск
твердые_шумные_смычные
	твердые_глухие_шумные_смычные	-гл=гх
	твердые_звонкие_шумные_смычные	-гл=зв
твердые_шумные_фрикативные
	твердые_глухие_шумные_фрикативные	-гл=гх
	твердые_звонкие_шумные_фрикативные -гл=зв
твердые_шумные
	твердые_шумные_смычные   -сп1=см
	твердые_шумные_фрикативные   -сп1=фр
твердые_согласные
	твердые_шумные   -сп0=шм 
	твердые_сонанты  -сп0=сн
твердые_гласные
	+a|а+
	+o|о+
	+e|э+
	+i|ы+	 -1
	+u|у+	 -2
твердые_fonemos
	твердые_согласные   -гс=сг
	твердые_гласные	 -гс=гл
return
	мягкие_fonemos  -мк=мг
	твердые_fonemos -мк=тв
`
var wordsFlags=`
g	gender
	=0  cant have gender
	=u  undefined
	=f  female
	=m  male
n   number
	=0  cant have number
	=u  undefined
	=s  single
	=m  multi
t	tense
	=0  cant have tense
	=u  undefined
	=p  past
	=n  present
	=f  future
s   stage
	=0  cant have stage
	=u  undefined
	=p  perfect
	=c  continuos
f   face
    =1  first
    =2  second
    =3  third
tr  translate
sp  part of speech
sp.t	part of speech type
`
var wordsConfig=`
spitxparto
	+non+	-tr=noun
	+pronon+	-tr=pronoun
	+verb+  -tr=verb
	+adj+	-tr=adjective
	+adv+	-tr=adverb
	+partisipl+ -tr=participle
	+kunig+ -tr=union
	+er+	-tr=particle
vortparto
	+prevort+	-tr=prefix
	+postvort+	-tr=postfix
lingo
	+fonem+ -tr=phonem
	+morphem+   -tr=morphem
mIsko
	+nom+	-tr=name
	+fon+	-tr=sound
	+vid+	-tr=video
	+aud+	-tr=audio
	+dom+	-tr=house
	+hejm+	-tr=home
	+vort+  -tr=word
	+temp+  -tr=time
	+spak+  -tr=space
	+vorld+ -tr=world
	+part+  -tr=part
	+nombr+ -tr=number
fudo
	+fud+	-tr=food
	+vod+	-tr=water
	+kuk+	-tr=cake
	+pom+	-tr=apple
	+pIr+	-tr=pear
	+banan+ -tr=banana
	+brasik+	-tr=cabbage
	+legom+ -tr=vegetable
	+tomat+ -tr=tomato
	+potat+ -tr=potato
	+karot+ -tr=carrot
	+orang+ -tr=orange
polo
	+gud+	-tr=good
	+bun+	-tr=boon
	+hot+	-tr=hot
	+vard+  -tr=forward
	+var+	-tr=war
interjeko
	+hay+	-tr=hello
	+pay+	-tr=hello if you just seen anybody but dont want to speak
	+bay+	-tr=bye
ad_non
	polo
	+pol+	-tr=polaris
	+fe+	-tr=female
	+me+	-tr=male
verb_non
	+vork+  -tr=work
	+vis+	-tr=look/see
verb_ad_non
	+kolor+ -tr=color
	+paint+ -tr=paint
kunigo
	+en+	-tr=and
	+an+	-tr=and/but
	+at+	-tr=but
ero
	+un+	-tr=un
	+nE+	-tr=not
	+zE+	-tr=the
	+lE+	-tr=do ... ?
	+from+  -tr=from
	+of+	-tr=of
	+viv+	-tr=with
	+in+	-tr=in
	+on+	-tr=on
	+at+	-tr=at
besto
	+kat+	-tr=cat
	+can+	-tr=dog
	+hom+	-tr=human
	+best+  -tr=animal
	+ran+	-tr=frog
	+vac+	-tr=cow
	+hors+  -tr=horse
	+kok+	-tr=chicken
	+pork+  -tr=pig
gen
	besto	-besto
	+kid+	-tr=kid
	+adult+ -tr=adult
	+sen+	-tr=old
fe+
	gen
me+
	gen
gen2
	gen -g=u
	fe+ -g=f
	me+ -g=m
transporto
	+aut+	-tr=car
	+avi+	-tr=plane
	+helikopter+	-tr=helicopter
	+multikopter+	-tr=multicopter
	+kopter+	-tr=helicopter/multicopter
	+kvadrokopter+  -tr=quadrocopter
	+transport+ -tr=transport
	+veturilo+ -tr=vehicle
	+train+ -tr=train
	+bus+	-tr=bus
	+tram+  -tr=tram
negen
	spitxparto  -spitxparto
	vortparto  -vortparto
	transporto  -transporto
	mIsko	-mIsko
	fudo	-fudo
	lingo   -lingo
non
	gen2
	negen	-g=0
nono
	non
	ad_non
	verb_non
	verb_ad_non
questions
	+ki+	-tr=anyquestion
pronono
	+m+ -tr=i -g=u  -f=1
	+v+ -tr=you -g=u  -f=2
	+l+ -tr=it -g=u  -f=3
	+fem+ -tr=i -g=f  -f=1
	+fev+ -tr=you -g=f  -f=2
	+fel+ -tr=it -g=f  -f=3
	+mem+ -tr=i -g=m  -f=1
	+mev+ -tr=you -g=m  -f=2
	+mel+ -tr=it -g=m  -f=3
+O
	pronono
modal
	+d+ -tr=do
	+c+ -tr=can
	+v+ -tr=would
	+x+ -tr=should
	+m+ -tr=must
	+y+ -tr=may
	+l+ -tr=shall
verb
	+s+ -tr=is
	+hav+	-tr=have
	+am+	-tr=love
	+sat+	-tr=like
	+vol+	-tr=want
	+don+	-tr=give
	+flug+  -tr=fly
	+far+	-tr=make
	+wait+  -tr=wait
	+sent+  -tr=feel
	modal   -modal
verbo
	verb
	verb_non
	verb_ad_non
+I
	verbo
+d
	+I
+m
	+I
+l
	+I
verbo_tense
	+I  -t=u
	+d  -t=p
	+m  -t=n
	+l  -t=f
+n
	verbo_tense
+z
	verbo_tense
verbo_stage
	verbo_tense -s=u
	+n  -s=c
	+z  -s=p
verbos
	verbo_stage
+r
	+I
+v
	+I
+o
	nono
	+r  -maker  -fromverb
	+v  -making  -fromverb
un+
	+o
	un+  un
+s
	+o
	+O
nombro
	+z+ -tr=zero
	+x+ -tr=one
	+b+ -tr=two-tr=
	+n+ -tr=three
	+w+ -tr=four
	+y+ -tr=five
	+r+ -tr=six
	+t+ -tr=seven
	+p+ -tr=eight
	+g+ -tr=nine
	+j+ -tr=ten
	+s+ -tr=eleven
koloro
	+rug+	-tr=red
	+orang+ -tr=orange
	+flav+  -tr=yellow
	+brun+  -tr=brown
	+verd+  -tr=green
	+blu+	-tr=blue
	+blank+ -tr=white
	+noir+  -tr=black
	+purpur+	-tr=purple
	+roz+	-tr=pink
ad
	koloro
	+rapid+ -tr=fast
	+h+ -tr=funny
	+kef+   -tr=main
	+propaj+    -tr=sobstvennoe
	+servis+    -tr=service
	ad_non
	verb_ad_non
	nombro
	+k+ -tr=this
+a
	pronono
	ad  -tr=adj
+e
	ad  -tr=adv
nonos_prononos
	+o  -n=s
	+O  -n=s
	+s  -n=m -tr=many
advos
	+e
adjos
	+a
interjekos
	interjeko
kunigos
	kunigo
eros
	ero
servisa_vortos
	kunigos -sp=kunigo
	eros -sp=ero
kefa_vortos
	nonos_prononos -sp=nono
	verbos -sp=verbo
	advos -sp=advo
	adjos -sp=adjo
vortos
	servisa_vortos  -sp.t=servisa
	kefa_vortos -sp.t=kefa
	interjekos -sp=interjeko
	propaj_vortos -sp=propaj
	questions   -__temp
return
	vortos
`
</script>
//Main script
<script>
			var toJSON=function(text)
			{
				var json={}
				var last
				for(var v in text.split("\n"))
				{
					if(!text.split("\n")[v].startsWith(tabSym))
						json[last=text.split("\n")[v]]=""
					else if(last)
						if(!json[last])
							json[last]=text.split("\n")[v].substr(1)
						else json[last]+="\n"+text.split("\n")[v].substr(1)
				}
				for(var v in json)
					if(json[v].split("\n").length>1)
					{
						json[v]=toJSON(json[v])
					}
					else
					{
						var vv=json[v]
						json[v]={}
						json[v][vv]={}
					}
				return json
			}
			var ress
			var onChange=function(json)
			{
				for(var v in json)
					for(var v2 in json[v])
					{
						var vv=v2.split(/\s+/)
						if(vv[0].startsWith("+")&&vv[0].endsWith("+"))
						{
							json[v][v2]=json[v][v2]
						}
						else
						{
							for(var v3 in json[vv[0]])
								json[v]["+"+(vv[0].endsWith("+")&&!vv[0].startsWith("+")?vv[0].replace("+","").replace("+",""):"")+v3.split(/\s+/)[0].replace("+","").replace("+","")+(vv[0].startsWith("+")&&!vv[0].endsWith("+")?vv[0].replace("+","").replace("+",""):"")+"+"+"\t"+(v3.split(/\s+/)[1]?v3.replace(v3.split(/\s+/)[0],""):"")+"\t"+v2.replace(vv[0],"").replace("+","").replace("+","")]={}
							delete json[v][v2]
						}
					}	
				var ress={}
				for(var v in json["return"])
					ress[v.split("\t")[0].replace("+","").replace("+","")]=v.substr(v.split("\t")[0].length).split(/\s+[-]/)
				return ress
			}
			
			fonemsConfig=fonemsConfig.replace("	","\t")
			var fonemsJson=toJSON(fonemsConfig)
			var fonems=onChange(fonemsJson)
			console.log(fonems)
			
			wordsConfig=wordsConfig.replace("	","\t")
			var wordsJson=toJSON(wordsConfig)
			var words=onChange(wordsJson)
			console.log(words)
			
			enterArea.oninput=fullDescriptionCheckbox.oninput=languageInput.oninput=function()
			{
			    var findFlag=function(flagConfig,flag, val)
			    {
			        var result=""
			        for(var v in flagConfig.split("\n"))
			            if(flagConfig.split("\n")[v].split(/\s+/)[0]==flag)
			                result=flagConfig.split("\n")[v].substr(flag.length)
			            else if(result&&val&&flagConfig.split("\n")[v].split(/\s+/)[1]=="="+val)
			                return flagConfig.split("\n")[v].substr(flagConfig.split("\n")[v].indexOf(val)+val.length+1)
			        return val&&result?val:(result?result:(val?val:flag))
			    }
			    var makeSingleDescription=function(flagConfig, arr)
			    {
			        var singleDescription=""
			        for(var v in arr)
			            if(fullDescriptionCheckbox.checked)
			                singleDescription+=findFlag(flagConfig,arr[v].split("=")[0])+(arr[v].split("=")[1]?"="+findFlag(flagConfig,arr[v].split("=")[0],arr[v].split("=")[1]):"")+"\t"
			            else singleDescription+=arr[v].split("=")[0]+(arr[v].split("=")[1]?"="+arr[v].split("=")[1]:"")+"\t"
			        return singleDescription
			    }
				{
					var enteredFonems=[]
					var inbr=false,connect=false
					for(var v in enterArea.value)
					{
					    //if(enterArea.value[v]!=":")
    					    if(inbr||connect)
    					        enteredFonems[enteredFonems.length-1]+=enterArea.value[v]
    					    else enteredFonems[enteredFonems.length]=enterArea.value[v]
					    if(enterArea.value[v]=="[")
					        inbr=true
					    if(enterArea.value[v]=="]")
					        inbr=false
					    //connect=enterArea.value[v]==":"
					}
					var fonemsResult=""
					for(var v in enteredFonems)
					{
						fonemsResult+="\""+enteredFonems[v]+"\""
						var ne=true
						for(var v22 in fonems)
						if(v22.split("|")[languageInput.value])
						{
						    var v2=v22.split("|")[languageInput.value]
							for(var v3 in v2.split("/"))
								if(v2.split("/")[v3]==enteredFonems[v]&&ne)
								{
									fonemsResult+=""+makeSingleDescription(fonemsFlags,fonems[v22])
									ne=false
								}
						}
						fonemsResult+="\n"
					}
					fonemsDescriptionArea.value=fonemsResult
				}
				{
					var enteredWords=enterArea.value.split(/\s+/)
					var wordsResult=""
					for(var v in enteredWords)
					{
						wordsResult+="\""+enteredWords[v]+"\""
						var ne=true
						for(var v22 in words)
						if(v22.split("|")[languageInput.value])
						{
						    var v2=v22.split("|")[languageInput.value]
							for(var v3 in v2.split("/"))
								if(v2.split("/")[v3]==enteredWords[v]&&ne)
								{
									wordsResult+=""+makeSingleDescription(wordsFlags,words[v22])
									ne=false
								}
						}
						wordsResult+="\n"
					}
					wordsDescriptionArea.value=wordsResult
				}
			}
		</script>
	</body>
</html>
